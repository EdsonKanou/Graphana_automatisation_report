Bonjour ! Je comprends votre situation. Vous avez raison : l'API `/api/ds/query` n'existe pas dans toutes les versions de Grafana ou n√©cessite une approche sp√©cifique.

Voici **plusieurs alternatives** pour r√©cup√©rer les valeurs r√©elles de votre dashboard :

## üìä Solutions recommand√©es

### **1. API Query Datasource (recommand√©e pour Grafana 12.x)**

Pour Grafana 12.1.0, utilisez l'endpoint `/api/datasources/proxy/{id}/query` :

```bash
curl -k -X POST \
  -H "Authorization: Bearer <API_KEY>" \
  -H "Content-Type: application/json" \
  https://<ton-grafana>/api/datasources/proxy/4/query \
  -d '{
    "queries": [
      {
        "refId": "A",
        "format": "table",
        "rawSql": "SELECT * FROM ma_table LIMIT 10",
        "datasourceId": 4
      }
    ]
  }'
```

### **2. API Dashboard + Reconstruction de la requ√™te**

R√©cup√©rez d'abord la d√©finition du panel, puis ex√©cutez la requ√™te :

**√âtape 1** - R√©cup√©rer le dashboard complet :
```bash
curl -k -H "Authorization: Bearer <API_KEY>" \
  https://<ton-grafana>/api/dashboards/uid/<DASHBOARD_UID>
```

**√âtape 2** - Extraire la requ√™te SQL du panel :
```json
{
  "panels": [{
    "targets": [{
      "rawSql": "SELECT time, value FROM metrics WHERE ...",
      "datasource": {"uid": "cebe2fax1rieob"}
    }]
  }]
}
```

**√âtape 3** - Ex√©cuter la requ√™te directement contre PostgreSQL :
```bash
# Option A : Via l'API Grafana datasource proxy
curl -k -X POST \
  -H "Authorization: Bearer <API_KEY>" \
  -H "Content-Type: application/json" \
  https://<ton-grafana>/api/datasources/proxy/4/query \
  -d '{"rawSql": "VOTRE_REQUETE_ICI"}'

# Option B : Directement sur PostgreSQL (si acc√®s possible)
psql -h <postgres-host> -U <user> -d <database> -c "VOTRE_REQUETE_ICI"
```

### **3. API Annotations (si applicable)**

Si votre panel utilise des annotations :
```bash
curl -k -H "Authorization: Bearer <API_KEY>" \
  "https://<ton-grafana>/api/annotations?dashboardId=<ID>&from=<timestamp>&to=<timestamp>"
```

### **4. Export via API Rendering (capture d'√©cran + OCR)**

Solution de dernier recours - exporter le panel en image :
```bash
curl -k -H "Authorization: Bearer <API_KEY>" \
  "https://<ton-grafana>/render/d-solo/<DASHBOARD_UID>/<PANEL_ID>?orgId=1&from=now-6h&to=now&width=1000&height=500" \
  -o panel.png
```

## üîç Informations dont j'ai besoin pour vous aider davantage :

1. **UID du dashboard** : Pour r√©cup√©rer sa d√©finition compl√®te
2. **ID du panel** : Le num√©ro du panel sp√©cifique qui vous int√©resse
3. **Type de visualisation** : Graph, Table, Stat, Gauge, etc. ?
4. **Exemple de requ√™te SQL** du panel (si vous l'avez sous les yeux dans l'interface Grafana)
5. **Acc√®s direct √† PostgreSQL** : Pouvez-vous vous connecter directement √† la base de donn√©es PostgreSQL ?

## ‚úÖ Prochaine √©tape recommand√©e

Essayez d'abord l'**option 2** (r√©cup√©rer le dashboard puis ex√©cuter la requ√™te), car c'est la plus fiable :

```bash
# 1. R√©cup√©rer le dashboard
curl -k -H "Authorization: Bearer <API_KEY>" \
  https://<ton-grafana>/api/dashboards/uid/<DASHBOARD_UID> | jq '.'

# 2. Cherchez dans la sortie JSON la section "targets" de votre panel
# 3. Copiez la requ√™te SQL
# 4. Ex√©cutez-la via le proxy datasource ou directement sur PostgreSQL
```

Dites-moi quel dashboard/panel vous cible et je vous aide √† construire la requ√™te exacte ! üöÄ